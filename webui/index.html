<!doctype html>
<meta charset="utf-8">
<title>FURA UI</title>
<style>
  body { font-family: system-ui, sans-serif; max-width: 900px; margin: 24px auto; }
  h1 { margin: 0 0 16px; }
  .row { margin: 8px 0; display:flex; gap:8px; align-items:center; }
  input[type=text] { width: 320px; }
  textarea { width: 100%; height: 140px; }
  button { padding: 8px 14px; }
  #out { white-space: pre-wrap; background:#f7f7f7; padding:12px; border-radius:8px; }
  .muted { color:#666; font-size: 12px; }
</style>

<h1>FURA UI</h1>

<div class="row">
  <label>Model:</label>
  <input id="model" type="text" value="llama3:8b">
  <span class="muted">/v1/chat i /ask používají stejný model gateway.</span>
</div>

<div class="row">
  <label>X-API-Key:</label>
  <input id="xkey" type="text" placeholder="(volitelné, jen pokud FURA_API_KEY)">
</div>

<p><b>Zadej dotaz:</b></p>
<textarea id="msg" placeholder="Ahoj, funguješ?"></textarea>

<div class="row">
  <button onclick="ask()">Odeslat přes /ask</button>
  <button onclick="chat()">Odeslat přes /v1/chat</button>
</div>

<h3>Odpověď</h3>
<pre id="out"></pre>

<script>
function headers() {
  const h = { "Content-Type":"application/json" };
  const key = document.getElementById('xkey').value.trim();
  if (key) h['X-API-Key'] = key; // jen když je potřeba
  return h;
}
function setOut(text) { document.getElementById('out').textContent = text; }

async function ask() {
  setOut('…');
  const body = {
    message: document.getElementById('msg').value,
    model: document.getElementById('model').value
  };
  const r = await fetch('/ask', {
    method: 'POST',
    headers: headers(),
    body: JSON.stringify(body)
  });
  const data = await r.json();
  setOut(data.response ?? JSON.stringify(data, null, 2));
}

async function chat() {
  setOut('…');
  const body = {
    model: document.getElementById('model').value,
    messages: [{role:'user', content: document.getElementById('msg').value}]
  };
  const r = await fetch('/v1/chat', {
    method: 'POST',
    headers: headers(),
    body: JSON.stringify(body)
  });
  const data = await r.json();
  setOut(data.answer ?? JSON.stringify(data, null, 2));
}
</script>
