<!doctype html>
<html lang="cs">
<head>
  <meta charset="utf-8" />
  <title>FURA UI</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; margin: 24px; }
    label { display:inline-block; margin-right:12px; }
    textarea { width: 100%; max-width: 960px; }
    pre { white-space: pre-wrap; background:#111; color:#ddd; padding:12px; border-radius:8px; max-width: 960px; }
    .row { margin: 8px 0; }
    button { padding: 8px 14px; }
    input[type="text"] { padding:6px; }
    select { padding:6px; }
  </style>
</head>
<body>
  <h1>FURA UI</h1>

  <div class="row">
    <label>Model:
      <select id="model">
        <option>llama3:8b</option>
        <option>codellama:7b-instruct</option>
        <option>mistral:7b</option>
        <option>starcoder:7b</option>
        <option>nous-hermes2:latest</option>
        <option>command-r:latest</option>
        <option>gpt-oss:latest</option>
      </select>
    </label>
    <label>X-API-Key:
      <input id="apikey" type="text" size="32" placeholder="(pokud je vyžadován)" />
    </label>
  </div>

  <div class="row">
    <textarea id="msg" rows="6" placeholder="Zadej dotaz..."></textarea>
  </div>

  <div class="row">
    <button id="send">Odeslat</button>
  </div>

  <pre id="out"></pre>

  <script>
    const keyEl = document.getElementById('apikey');
    keyEl.value = localStorage.getItem('fura_api_key') || '';
    keyEl.addEventListener('change', ()=>localStorage.setItem('fura_api_key', keyEl.value));

    document.getElementById('send').addEventListener('click', async () => {
      const apikey = keyEl.value.trim();
      const model = document.getElementById('model').value;
      const msg = document.getElementById('msg').value;

      const r = await fetch('/v1/chat', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          ...(apikey ? {'X-API-Key': apikey} : {})
        },
        body: JSON.stringify({ model, messages: [{ role: 'user', content: msg }] })
      });
      const text = await r.text();
      try {
        const j = JSON.parse(text);
        document.getElementById('out').textContent = j.answer ?? JSON.stringify(j, null, 2);
      } catch(e) {
        document.getElementById('out').textContent = text;
      }
    });
  </script>
</body>
</html>
